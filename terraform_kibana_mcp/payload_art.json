{"connector_id":"7e984d1b-59c4-48e3-9b6d-b833883a5439","namespace":"art","skip_existing":true,"tags":[],"tools":[{"description":"Download and reload atomic tests from the GitHub repository.\n\nThis tool forces a fresh download of all atomic tests from the configured GitHub\nrepository, replacing any existing local copies. It then reloads all tests into\nmemory, making them immediately available for querying and execution.\n\nUse this tool when:\n- You want to get the latest atomic tests from the repository\n- Custom atomic tests were added to the data directory\n- The atomic test database needs to be refreshed\n- You suspect the loaded tests are out of sync with the repository\n\nArgs:\n    ctx: MCP context (provided automatically by the framework)\n\nReturns:\n    str: Success message indicating the number of atomic tests refreshed\n         Example: \"Successfully refreshed 342 atomics\"\n\nProcess:\n    1. Deletes existing atomic tests directory (if present)\n    2. Clones the GitHub repository (configured via ART_GITHUB_* settings)\n    3. Extracts the atomics directory from the repository\n    4. Parses all YAML files and validates them\n    5. Loads atomic tests into server memory\n    6. Makes tests immediately available to other tools\n\nConfiguration:\n    The repository location is controlled by environment variables:\n    - ART_GITHUB_URL: Base GitHub URL (default: https://github.com)\n    - ART_GITHUB_USER: User/organization (default: redcanaryco)\n    - ART_GITHUB_REPO: Repository name (default: atomic-red-team)\n    - ART_DATA_DIR: Local storage path (default: ./atomics)\n\nExamples:\n    # Refresh from default repository\n    refresh_atomics(ctx)\n\n    # After setting custom repo in .env:\n    # ART_GITHUB_USER=your-org\n    # ART_GITHUB_REPO=custom-atomics\n    refresh_atomics(ctx)\n\nRaises:\n    Exception: If Git clone fails (network issues, invalid repository)\n    Exception: If atomic test parsing fails (invalid YAML format)\n    Exception: If disk space is insufficient for repository clone\n\nNotes:\n    - This operation may take 30-60 seconds depending on network speed\n    - Requires internet connectivity to GitHub\n    - Overwrites any local modifications to atomic tests\n    - The repository is cloned with depth=1 for efficiency (only latest commit)\n    - Failed YAML files are logged but don't stop the overall refresh","name":"refresh_atomics"},{"description":"Search and filter atomic tests across the repository.\n\nThis tool searches through all atomic tests and returns matches based on your\ncriteria. You can search by free-text query, or filter by specific attributes like\ntechnique ID, GUID, or platform.\n\nArgs:\n    query: Free-text search term to match against all atomic test fields including\n           name, description, commands, and input arguments. Supports multi-word\n           queries where all words must match (AND logic).\n           Examples: \"powershell registry\", \"credential access\", \"T1059\"\n\n    guid: Filter by exact atomic test GUID (UUID format).\n          Example: \"a8c41029-8d2a-4661-ab83-e5104c1cb667\"\n          Use this when you know the specific test you want to retrieve.\n\n    technique_id: Filter by MITRE ATT\u0026CK technique ID. Must follow the format\n                  T#### or T####.### (e.g., T1059, T1059.001).\n                  Example: \"T1059.001\" for PowerShell technique\n                  Returns all atomic tests associated with this technique.\n\n    technique_name: Filter by technique name (case-insensitive partial match).\n                    Example: \"Command and Scripting Interpreter\"\n                    Useful when you know the technique name but not the ID.\n\n    supported_platforms: Filter by platform (case-insensitive partial match).\n                        Valid platforms: windows, linux, macos, office-365, azure-ad,\n                        google-workspace, saas, iaas, containers, iaas:aws, iaas:azure,\n                        iaas:gcp, esxi\n                        Example: \"windows\", \"linux\", \"macos\"\n\nReturns:\n    List[MetaAtomic]: A list of matching atomic tests. Each test includes:\n        - name: Descriptive name of the test\n        - description: Detailed explanation of what the test does\n        - technique_id: Associated MITRE ATT\u0026CK technique ID\n        - technique_name: Human-readable technique name\n        - supported_platforms: List of platforms where test can run\n        - executor: Execution details (command, cleanup, etc.)\n        - input_arguments: Configurable parameters for the test\n        - auto_generated_guid: Unique identifier for the test\n\nExamples:\n    # Find all PowerShell-related tests\n    query_atomics(ctx, query=\"powershell\")\n\n    # Find all Windows registry tests\n    query_atomics(ctx, query=\"registry\", supported_platforms=\"windows\")\n\n    # Find specific technique\n    query_atomics(ctx, query=\"\", technique_id=\"T1059.001\")\n\n    # Find test by GUID\n    query_atomics(ctx, query=\"\", guid=\"a8c41029-8d2a-4661-ab83-e5104c1cb667\")\n\nRaises:\n    ValueError: If query is empty or exceeds 1000 characters\n    ValueError: If technique_id format is invalid (must be T#### or T####.###)","name":"query_atomics"},{"description":"Get the JSON schema that defines the structure and requirements for atomic tests.\n\nThis schema provides the complete specification for creating valid atomic tests. It defines\nall fields (required and optional), data types, validation rules, and constraints. Use this\nas a reference when creating or modifying atomic tests to ensure they meet quality standards.\n\nThe schema follows the Atomic Red Team YAML format and is automatically generated from\nthe Pydantic models, ensuring it's always in sync with validation rules.\n\nReturns:\n    dict: JSON Schema (Draft 7) containing:\n        - definitions: Nested object definitions (Executor, Dependency, etc.)\n        - properties: Field definitions with types and constraints\n        - required: List of mandatory fields\n        - additionalProperties: Whether extra fields are allowed\n        - field descriptions: Human-readable explanations for each field\n\nSchema Structure:\n    The schema defines these main sections:\n    - name: Test name (required, min 1 character)\n    - description: Test explanation (required, min 1 character)\n    - supported_platforms: Platform list (required, min 1 platform)\n    - executor: Execution method (required, CommandExecutor or ManualExecutor)\n    - input_arguments: Parameterized inputs (optional, dict)\n    - dependencies: Prerequisites (optional, list)\n    - dependency_executor_name: Executor for dependencies (optional)\n    - auto_generated_guid: Unique ID (optional, auto-generated)\n\nExamples:\n    # Get the schema\n    schema = get_validation_schema()\n\n    # Check required fields\n    required_fields = schema['required']\n    print(f\"Required fields: {required_fields}\")\n\n    # View field definitions\n    properties = schema['properties']\n    print(f\"Available fields: {list(properties.keys())}\")\n\n    # Check platform options\n    platform_enum = schema['definitions']['Platform']['enum']\n    print(f\"Valid platforms: {platform_enum}\")\n\nCommon Use Cases:\n    1. **Creating new tests**: Reference required fields and formats\n    2. **Understanding validation**: See what rules will be enforced\n    3. **Tool development**: Use schema for code generation\n    4. **Documentation**: Generate field descriptions automatically\n\nNotes:\n    - Schema is generated from Pydantic models at runtime\n    - Always reflects current validation rules\n    - Includes custom validators and constraints\n    - Follows JSON Schema Draft 7 specification\n    - Can be used with JSON Schema validators in any language\n    - Do not add comments to the created atomic test","name":"get_validation_schema"},{"description":"Execute an atomic test on the server.\n\n⚠️ WARNING: This tool executes security tests that may modify system state, create files,\nor perform actions that security tools may flag as malicious. Only use in controlled,\nisolated environments (test VMs, sandboxes).\n\nThis tool runs a specific atomic test by its GUID. If you don't know the GUID, use the\n`query_atomics` tool first to search for tests and retrieve their GUIDs. The tool will\nprompt you for any required input arguments before execution.\n\nArgs:\n    auto_generated_guid: The unique identifier (UUID) of the atomic test to execute.\n                        Example: \"a8c41029-8d2a-4661-ab83-e5104c1cb667\"\n\n                        To find a test's GUID:\n                        1. Use query_atomics to search for tests\n                        2. Look for the auto_generated_guid field in the results\n                        3. Pass that GUID to this function\n\n                        If not provided, you will be prompted to enter it interactively.\n\nReturns:\n    str: Execution result message containing:\n        - Success/failure status\n        - Command output (stdout/stderr)\n        - Exit codes\n        - Any execution errors or warnings\n\n        The exact format depends on the executor type (powershell, bash, sh, cmd, manual)\n\nInteractive Prompts:\n    - If auto_generated_guid is not provided, you'll be asked to provide it\n    - For tests with input_arguments, you'll be prompted for each argument:\n      * You can accept the default value by typing \"default\"\n      * Or provide a custom value\n      * Each prompt shows the argument description and default value\n    - You can cancel execution at any time during prompts\n\nExamples:\n    # Execute a specific test\n    execute_atomic(ctx, auto_generated_guid=\"a8c41029-8d2a-4661-ab83-e5104c1cb667\")\n\n    # Execute interactively (will prompt for GUID)\n    execute_atomic(ctx)\n\nWorkflow:\n    1. Use query_atomics to find tests:\n       query_atomics(ctx, query=\"powershell registry\")\n\n    2. Copy the auto_generated_guid from results\n\n    3. Execute the test:\n       execute_atomic(ctx, auto_generated_guid=\"\u003cguid\u003e\")\n\n    4. Review the execution output\n\n    5. If needed, run cleanup (if test has cleanup_command)\n\nRaises:\n    Exception: If test GUID is not found in the atomic tests database\n    Exception: If execution fails due to system errors or invalid commands\n\nNotes:\n    - This tool is disabled by default (requires ART_EXECUTION_ENABLED=true)\n    - Tests run with the same privileges as the MCP server\n    - Tests with elevation_required=true need sudo/admin privileges\n    - Check test details with query_atomics before execution\n    - Review supported_platforms to ensure compatibility","name":"execute_atomic"},{"description":"Validate an atomic test YAML string against the official Atomic Red Team schema.\n\nThis tool checks if your atomic test follows the correct structure and includes all\nrequired fields. Use this before finalizing any atomic test to ensure it meets\nthe quality standards and can be properly parsed by Atomic Red Team tools.\n\nThe validator performs two levels of checks:\n1. **Structural validation**: Ensures all required fields are present and properly typed\n2. **Best practice warnings**: Flags common issues that should be addressed\n\nArgs:\n    yaml_string: The complete YAML string of the atomic test to validate.\n                Should include all fields like name, description, supported_platforms,\n                executor, etc. as defined in the schema.\n\nReturns:\n    dict: Validation result containing:\n        - valid (bool): Whether the atomic test passes validation\n        - message (str): Human-readable success/error message with warnings prominently displayed\n        - atomic_name (str): Name of the atomic test (only if valid)\n        - supported_platforms (list): Platforms the test supports (only if valid)\n        - warnings (list): List of warning messages for best practice violations (only if present)\n        - error (str): Detailed error message (only if invalid)\n\nValidation Warnings:\n    The tool will flag these common issues with ⚠️  warnings:\n    - Presence of 'auto_generated_guid' field (should be auto-generated, not manually set)\n    - Use of echo/print/Write-Host commands (discouraged in test commands)\n\n    Warnings do not cause validation to fail, but should be addressed before finalizing.\n\nExamples:\n    # Valid atomic test\n    yaml_str = '''\n    name: Test PowerShell Execution\n    description: Execute a PowerShell command\n    supported_platforms:\n      - windows\n    executor:\n      name: powershell\n      command: Get-Process\n    '''\n    result = validate_atomic(yaml_str, ctx)\n    # Returns: {\"valid\": True, \"message\": \"✅ Atomic test validation successful...\", ...}\n\n    # Test with warnings (still valid but needs improvement)\n    yaml_str = '''\n    name: Test with Echo\n    description: Test with echo command\n    supported_platforms:\n      - linux\n    executor:\n      name: bash\n      command: echo \"Hello World\"\n    '''\n    result = validate_atomic(yaml_str, ctx)\n    # Returns: {\"valid\": True, \"message\": \"✅ Atomic test validation successful\n    #          ⚠️  WARNING: Avoid echo/print/Write-Host statements...\", \"warnings\": [...]}\n\n    # Invalid atomic test (missing required field)\n    yaml_str = '''\n    name: Incomplete Test\n    description: Missing supported_platforms\n    executor:\n      name: bash\n      command: ls\n    '''\n    result = validate_atomic(yaml_str, ctx)\n    # Returns: {\"valid\": False, \"error\": \"Validation error: ...\"}\n\nRaises:\n    No exceptions are raised - all errors are returned in the result dictionary.\n\nNotes:\n    - Always check the 'valid' field before using the atomic test\n    - Address all warnings even if validation succeeds\n    - Warnings are displayed with ⚠️  emoji for visibility\n    - The 'message' field contains formatted text with warnings prominently shown","name":"validate_atomic"}]}
